<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<link rel="stylesheet" type="text/css" href="css/lib/font-awesome.min.css">
		<link rel="stylesheet" type="text/css" href="css/lib/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/common.css">
		<link rel="stylesheet" type="text/css" href="css/successconfirmdialog.css">
		<link rel="stylesheet" type="text/css" href="css/confirmdialog.css">
		<link rel="stylesheet" type="text/css" href="css/errorconfirmdialog.css">
		<script type="text/javascript" src="js/lib/jquery-1.11.3.min.js"></script>
		<script type="text/javascript" src="js/lib/bootstrap.min.js"></script>

        <script type="text/javascript" src="js/utils.js"></script>
		<script type="text/javascript" src="js/order-tab.js"></script>
		<script type="text/javascript" src="js/recipe-tab.js"></script>
		<script type="text/javascript" src="js/ingredient-tab.js"></script>
		<script type="text/javascript" src="js/purchaselist.js"></script>

		<script>
		    var ingredientFilters = ["All", "Maligai", "KaaiKanigal", "Extras", "Suppliments"];
		    var ingredientCategories = ["Maligai", "KaaiKanigal", "Extras", "Suppliments"];
		    var ingredientUnits = ["gram", "ml", "nos", "kattu", "kowli", "pocket", "meter"];
		    var recipeCategory = ["Sweet", "HomeSweet", "Kaaram", "Idly", "Dhosa", "Chattni", "Sambar", "Kulambu", "Gravy", "Rotty", "Biriyani", "Pachadi", "Saadam", "Oorugaai", "Baanam", "Snacks"];
			var recipeFilters = ["All", "Sweet", "HomeSweet", "Kaaram", "Idly", "Dhosa", "Chattni", "Sambar", "Kulambu", "Gravy", "Rotty", "Biriyani", "Pachadi", "Saadam", "Oorugaai", "Baanam", "Snacks"];	
		    var ingredientJson = {};
		    var recipeJson = {};
		    var recipeNames = {};

        </script> 
     </head>
	<body>
		<div class="cls_pageContainer container-fluid col" id="id_pageIndex">
			<div class="cls_pageHeader">
				<div id="id_pageHeader" class="row">
					<div class="col-3 text-center p-2">
						<div class="text-danger font-weight-bold">
							Name - 1
						</div>
						<div>
							9874563210
						</div>
						<br>
						<div class="text-danger font-weight-bold">
							Name - 2
						</div>
						<div>
							9874563210
						</div>	
					</div>
					<div class="col-6 text-center">
						<img src="css/images/logo.png" class="img-rounded" alt="Sulur Vignesh Catering">
					</div>
					<div class="col-3 text-center p-2">
						<div class="text-danger font-weight-bold">
							Name - 3
						</div>
						<div>
							9874563210
						</div>
						<br>
						<div class="text-danger font-weight-bold">
							Name - 4
						</div>
						<div>
							9874563210
						</div>	
					</div>
				</div>
				<div class="row text-center bg-secondary">
					<div class="col font-italic text-light text-center">
						VIP Garden, Ranganathapuram, Sulur, Coimbatore - 641 002
					</div>
				</div>
			</div>
			<div class="p-2">
				<ul class="nav nav-tabs text-center" id="id_homepage" role="tablist">
				  	<li class="nav-item col-4">
				    	<a class="nav-link active font-weight-bold" id="id_order-tab" data-toggle="tab" href="#id_orderContent_tab" role="tab" aria-controls="order" aria-selected="true">Order</a>
				  	</li>
				  	<li class="nav-item col-4">
				   		<a class="nav-link font-weight-bold" id="id_recipe-tab" data-toggle="tab" href="#id_recipeContent_tab" role="tab" aria-controls="recipe" aria-selected="false">Recipe</a>
				  	</li>
				  	<li class="nav-item col-4">
				    	<a class="nav-link font-weight-bold" id="id_ingredient-tab" data-toggle="tab" href="#id_ingredientContent_tab" role="tab" aria-controls="ingredient" aria-selected="false">Ingredient</a>
				  	</li>
				</ul>

				<div class="tab-content p-4" id="myTabContent">
					<div class="tab-pane fade show active" id="id_orderContent_tab" role="tabpanel" aria-labelledby="id_order-tab">
						<div class="text-right col-11 pb-4">
							<a href="#" id="id_createOrder" class="btn btn-primary btn-md mr-3 col-2">
					          <i class="fa fa-plus-circle" aria-hidden="true"></i> Create New Order
					        </a>
					        <a id="id_back" class="btn btn-primary btn-md mr-3 col-1 text-white backFromCreateOrder d-none">
					          <i aria-hidden="true"></i> Back
					        </a>
						</div>
					</div>

				  	<div class="tab-pane fade" id="id_recipeContent_tab" role="tabpanel" aria-labelledby="id_recipe-tab">
				  		<div class="row">
				  			<div class="col-3 pb-4">
						        <div class="form-group">
								    <label for="selectRecipeCategory">Select Category</label>
								    <select class="form-control" id="id_selectRecipeCategory" name="selectRecipeCategory"></select>
								</div>
							</div>
							<div class="col-3 pb-4">
						        <div class="form-group">
								    <label for="searchIngredientCategory">Search Recipe</label>
								    <input type="text" class="form-control cls_searchRecipeCategory" required="" id="id_searchRecipeCategory" placeholder="Enter Recipe Name" name="searchRecipeCategory">
								</div>
							</div>
					  		<div id="id_createRecipe" class="text-right col-5 mt-4 pt-2">
								<a data-toggle="modal" data-target="#recipeModal" class="btn btn-primary btn-md mr-3 text-white cls_createRecipe">
						          <i class="fa fa-plus-circle" aria-hidden="true"></i> Create Recipe
						        </a>
						    </div>
						</div>
						<div class="cls_recipeList"></div>
				  	</div>

				 	<div class="tab-pane fade" id="id_ingredientContent_tab" role="tabpanel" aria-labelledby="id_ingredient-tab">
				 	    <div class="row">
					 		<div class="col-3 pb-4">
						        <div class="form-group">
								    <label for="selectIngredientCategory">Select Category</label>
								    <select class="form-control" id="id_selectIngredientCategory" name="selectIngredientCategory"></select>
								</div>
							</div>
							<div class="col-3 pb-4">
						        <div class="form-group">
								    <label for="searchIngredientCategory">Search Ingredients</label>
								    <input type="text" class="form-control cls_searchIngredientCategory" required="" id="id_searchIngredientCategory" placeholder="Enter Ingredient Name" name="searchIngredientCategory">
								</div>
							</div>

							<div id="id_createIngredient" class="text-right col-5 mt-4 pt-2">
								<a class="btn btn-primary btn-md mr-3 text-white cls_createIngredient" data-toggle="modal" data-target="#ingredientModal">
						          <i class="fa fa-plus-circle" aria-hidden="true"></i> Create Ingredient
						        </a>
						    </div>
					    </div>
					    <div class="cls_ingredientsList"></div>
				 	</div>

				</div>
			</div>
		</div>
		
	 <!--Ingredient Modal -->
	 <div class="modal fade" id="ingredientModal" role="dialog">
	   <div class="modal-dialog">
	     <!-- Modal content-->
	     <div class="modal-content">
	       <div class="modal-header">
	       <h4 class="modal-title">Create Ingredient</h4>
	         <button type="button" class="close" data-dismiss="modal">&times;</button>
	       </div>
	       <div class="modal-body">
	         <form id="id_createIngredientForm">
	            <div class="form-group d-none">
			      <label for="id">Id</label>
			      <input type="text" class="form-control cls_ingredientId" id="id_id" placeholder="Enter Id" name="id">
			    </div>
			    <div class="form-group">
			      <label for="tamilname">Tamil Name*</label>
			      <input type="text" class="form-control cls_ingredientTamilName" required id="id_tamilName" placeholder="Enter Tamil Name" name="tamilname">
			    </div>
			    <div class="form-group">
				  	<label for="ingredientUnit">Unit</label>
                    <select class="form-control cls_ingredientUnit" id="id_ingredientUnit" name="ingredientUnit"></select>
				</div>
				<div class="form-group">
				  	<label for="ingredientCategory">Category</label>
                    <select class="form-control cls_ingredientCategory" id="id_ingredientCategory" name="ingredientCategory"></select>
				</div>
			    <div class="row float-right p-2">
			        <div class="btn btn-primary mt-2 cls_saveIngredient">Save</div>
			    </div>
		     </form>
	       </div>
	     </div>
   		</div>
     </div>
	     
	     <!--Recipe Modal -->
	 <div class="modal fade" id="recipeModal" role="dialog">
	   <div class="modal-dialog">
	     <!-- Modal content-->
	     <div class="modal-content cls_recipeCreateModal" style="width: 800px;">
	       <div class="modal-header">
	       <h4 class="modal-title">Create Recipe</h4>
	         <button type="button" class="close" data-dismiss="modal">&times;</button>
	       </div>
	       <div class="modal-body">
	         <form id="id_createRecipeForm">
			    <div class="form-group">
			      <label for="name">Name</label>
			      <input type="text" class="form-control" required id="id_recipeName" placeholder="Enter name" name="name">
			    </div>
			    <div class="form-group">
			      <label for="tamilname">Tamil Name</label>
			      <input type="text" class="form-control" required id="id_recipeTamilName" placeholder="Enter Tamil Name" name="tamilname">
			    </div>
				<div class="form-group">
				  	<label for="recipeCategory">Category</label>
                    <select class="form-control" id="id_recipeCategory" name="recipeCategory"></select>
				</div>
				<div class="form-group">
				  	<label for="recipeHeadCount">Head Count</label>
                    <input type="text" class="form-control" required id="id_recipeHeadCount" placeholder="Enter Head Count" name="recipeHeadCount">
				</div>
				<h5><u>Add Ingredients to the Recipe</u></h5>
				<div class="form-group">
				    <div class="createRecipeIngredientMap">
					    <div class="row cls_ingredientMapRow">
						    <div class="col-3">
							  	<label for="ingredientCategory">Category</label>
			                    <select class="form-control cls_ingredientCategory_recipe" id="id_ingredientCategory_recipe" name="ingredientCategory">
			                    <option>Choose Category</option></select>
		                    </div>
		                    <div class="col-4">
							  	<label for="ingredientName">Name</label>
			                    <select class="form-control cls_ingredientName_recipe" id="id_ingredientName_recipe" name="ingredientName"></select>
		                    </div>
		                    <div class="col-2">
						      <label for="qunatity">Quantity</label>
						      <input type="text" class="form-control cls_ingredientQunatity_recipe" required id="id_ingredientQunatity_recipe" placeholder="Enter Quantity" name="qunatity">
						    </div>
		                    <div class="col-2">
							  	<label for="ingredientUnit">Unit</label>
			                    <select class="form-control cls_ingredientUnit_recipe" id="id_ingredientUnit_recipe" name="ingredientUnit"></select>
		                    </div>
						    <div class="col-1">
						    </div>
	                    </div>
				    </div>
				     <div class="row">
				        <div class="col text-right">
				    		<div class="btn btn-success mt-2 cls_addIngredient">Add</div>
				    	</div>
				    </div>
				</div>
				<div class="row float-right p-2">
			        <div class="btn btn-primary mt-2 cls_saveRecipe">Save</div>
			    </div>
		     </form>
	        </div>
	      </div>
	     </div>
     </div>

     <div class="modal fade bd-example-modal-lg loadingguage" data-backdrop="static" data-keyboard="false" tabindex="-1">
	    <div class="modal-dialog modal-sm">
	        <div class="modal-content">
	            <span class="fa fa-spinner fa-spin fa-3x"></span>
	        </div>
	    </div>
	</div>


     <!-- Success Popup -->
     <div id="successPopup" class="modal fade in">
		<div class="modal-dialog modal-success">
			<div class="modal-content">
				<div class="modal-header">
					<div class="icon-box">
						<b><i class="material-icons">✓</i></b>
					</div>				
					<h4 class="modal-title">Successfully Done !!</h4>	
				</div>
				<!-- <div class="modal-body">
					<p class="text-center">Ingredient Has been Created Successfully !!</p>
				</div> -->	
				<div class="modal-footer">
					<button class="btn btn-success cls_successPopupClose btn-block font-weight-bold" data-dismiss="modal">OK</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Confirmation Popup -->
	<div id="confirmationPopup" class="modal fade in">
		<div class="modal-dialog modal-confirm">
			<div class="modal-content">
				<div class="modal-header row">
					<div class="icon-box">
						<b><i class="material-icons">?</i></b>
					</div>
					<h4 class="modal-title col-12">Are you sure?</h4>
	                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				</div>
				<!-- <div class="modal-body">
					<p>Do you really want to delete these records? This process cannot be undone.</p>
				</div> -->
				<div class="modal-footer">
					<button type="button" class="btn btn-info" data-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-danger cls_confirmPopupDelete">Delete</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Error Popup -->
	<div id="errorPopup" class="modal fade in">
		<div class="modal-dialog modal-error">
			<div class="modal-content">
				<div class="modal-header row">
					<div class="icon-box">
						<b><i class="material-icons">X</i></b>
					</div>
					<h4 class="modal-title col-12">Failed Temporarily</h4>
	                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				</div>
				<!-- <div class="modal-body">
					<p>Do you really want to delete these records? This process cannot be undone.</p>
				</div> -->
				<div class="modal-footer">
					<button class="btn btn-danger btn-block font-weight-bold cls_errorPopupClose" data-dismiss="modal">OK</button>
				</div>
			</div>
		</div>
	</div>
		
	</body>
	<script type="text/javascript">	
        $(document).on('ready', function() {
            /*new OrderTab();
            new RecipeTab();
            new IngredientTab();*/
            new IngredientTab();
            new RecipeTab();
            new OrderTab();

			$('#successPopup').on('hidden.bs.modal', function () {
			    $(this).find('.modal-title').text("Successfully Done !!");
			});
			$('#confirmationPopup').on('hidden.bs.modal', function () {
			    $(this).find('.modal-title').text("Are you sure?");
			});
			$('#errorPopup').on('hidden.bs.modal', function () {
			    $(this).find('.modal-title').text("Failed Temporarily");
			});
			$('#ingredientModal').on('hidden.bs.modal', function () {
			    $(this).find(".cls_ingredientCategory").prop('disabled', false);
			});

			var urlParts = getUrlParts(window.location.href);
			if(urlParts && urlParts.tab)
			{
				if(urlParts.tab == "ingredients")
				{
					$("#id_ingredient-tab").click();
				}
				else if(urlParts.tab == "recipe")
				{
					$("#id_recipe-tab").click();
				}
				else if(urlParts.tab == "order")
				{
					$("#id_order-tab").click();
				}
			}

			$(".cls_successPopupClose").click(function() {
				if($("#id_ingredient-tab").hasClass("active") == true)
				{
					window.location.href = window.location.origin + "?tab=ingredients";
				}
				else if($("#id_recipe-tab").hasClass("active") == true)
				{
					window.location.href = window.location.origin + "?tab=recipe";
				}
		    });

			$(".cls_confirmPopupDelete").click(function() {

				if($("#confirmationPopup").data("module") == "Ingredient")
				{
					var ingJson = {};
	 				var reqKey = $("#confirmationPopup").data("catForId");
				    if(reqKey != -1)
				    {
				    	showLoading();
					    ingJson[reqKey] =
			    		{
				    		"id": $("#confirmationPopup").data("idToDelete")
					    };
				        $.ajax({
				        	url: "/deleteIngredient",
			            	type: "post",
			            	contentType: 'application/json',
			            	data: JSON.stringify(ingJson),
				        	success: function(result){
				        		hideLoading();
				        		if(result.nModified && result.nModified>0)
				        		{
									$("#successPopup").find('.modal-title').text("Ingredient Deleted Successfully");
					        		$("#successPopup").modal('show');
				        		}
				        		else
				        		{
				        			$("#errorPopup").find('.modal-title').text('Failed to delete Ingredient at the moment. Please Try again later.');
				        			$("#errorPopup").modal('show');
				        		}
				        		$("#confirmationPopup").modal('hide');
							},
							error: function(){
								hideLoading();
							    $("#errorPopup").find('.modal-title').text('Failed to delete Ingredient. Please Try again later.');
				        		$("#errorPopup").modal('show');
				        		$("#confirmationPopup").modal('hide');
							}
						});
				    }
				    else
				    {
				    	$("#errorPopup").find('.modal-title').text('Failed to delete Ingredient. Please Try again later.');
				        $("#errorPopup").modal('show');
				        $("#confirmationPopup").modal('hide');
				    }
				}

				else if($("#confirmationPopup").data("module") == "Recipe")
				{
					var recipeJsonToDelete = {};
				    showLoading();
				    recipeJsonToDelete["Recipe"] =
		    		{
			    		"id": $("#confirmationPopup").data("idToDelete")
				    };
			        $.ajax({
			        	url: "/deleteRecipe",
		            	type: "post",
		            	contentType: 'application/json',
		            	data: JSON.stringify(recipeJsonToDelete),
			        	success: function(result){
			        		hideLoading();
			        		if(result.nModified && result.nModified>0)
			        		{
								$("#successPopup").find('.modal-title').text("Recipe Deleted Successfully");
				        		$("#successPopup").modal('show');
			        		}
			        		else
			        		{
			        			$("#errorPopup").find('.modal-title').text('Failed to delete Recipe at the moment. Please Try again later.');
			        			$("#errorPopup").modal('show');
			        		}
			        		$("#confirmationPopup").modal('hide');
						},
						error: function(){
							hideLoading();
						    $("#errorPopup").find('.modal-title').text('Failed to delete Recipe. Please Try again later.');
			        		$("#errorPopup").modal('show');
			        		$("#confirmationPopup").modal('hide');
						}
					});
				}

		    });

        });
     </script>
</html>